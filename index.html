<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raspadinha Bíblica</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@700&display=swap');

        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f0f0;
            font-family: 'Georgia', serif;
            text-align: center;
        }

        h1 {
            font-family: 'Great Vibes', cursive;
            font-size: 42px;
            color: #f83d3d;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        .card {
            position: relative;
            width: 320px;
            height: 250px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            overflow: hidden;
        }

        #verse {
            font-size: 21px;
            font-weight: bold;
            font-style: italic;
            color: #222;
            font-family: 'Palatino Linotype', 'Book Antiqua', Palatino, serif;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        #reference {
            font-size: 16px;
            font-weight: normal;
            color: #777;
            margin-top: 1px;
        }

        .logo {
            margin-top: -6px;
            width: 75px;
            height: auto;
        }

        .scratch-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            cursor: grab;
        }

        .message {
            color: red;
            font-size: 13px;
            font-weight: bold;
            margin-top: -3px;
            font-family:'Book Antiqua'

        }
    </style>
</head>
<body>
    <h1>Raspe seu versículo de hoje</h1>

    <div class="card">
        <p id="verse"></p>
        <p id="reference"></p>
        <img src="logo.png" alt="Logo" class="logo">
        <canvas class="scratch-canvas"></canvas>
        <p class="message" id="message"></p>
    </div>

    <script>
        const verses = [
            { text: "O Senhor é meu pastor, nada me falta.", reference: "Salmos 23:1" },
            { text: "Porque Deus amou o mundo de tal maneira...", reference: "João 3:16" },
            { text: "Quem nos separará do amor de Cristo? Será tribulação, ou angústia, ou perseguição?", reference: "Romanos 8:35" }
        ];

        const canvas = document.querySelector('.scratch-canvas');
        const ctx = canvas.getContext('2d');
        const card = document.querySelector('.card');
        const message = document.getElementById('message');

        function resizeCanvas() {
            canvas.width = card.offsetWidth;
            canvas.height = card.offsetHeight;
            ctx.fillStyle = 'gray';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);

        let isDrawing = false;

        function getMousePos(e) {
            const rect = canvas.getBoundingClientRect();
            return { x: e.clientX - rect.left, y: e.clientY - rect.top };
        }

        function getTouchPos(e) {
            const rect = canvas.getBoundingClientRect();
            const touch = e.touches[0];
            return { x: touch.clientX - rect.left, y: touch.clientY - rect.top };
        }

        function scratch(e) {
            if (!isDrawing) return;
            e.preventDefault();
            const { x, y } = e.touches ? getTouchPos(e) : getMousePos(e);

            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath();
            ctx.arc(x, y, 20, 0, Math.PI * 2);
            ctx.fill();
        }

        // Função para obter ou definir o versículo do dia no localStorage
        function getTodaysVerse() {
            const currentDate = new Date().toLocaleDateString();
            const savedData = JSON.parse(localStorage.getItem('todaysVerse'));

            if (savedData && savedData.date === currentDate) {
                return savedData.verse;
            } else {
                const newVerse = verses[Math.floor(Math.random() * verses.length)];
                localStorage.setItem('todaysVerse', JSON.stringify({ date: currentDate, verse: newVerse }));
                return newVerse;
            }
        }

        function checkLastUsedDate() {
            const currentDate = new Date().toLocaleDateString();
            const lastUsedDate = localStorage.getItem('lastUsedDate');
            const todaysVerse = getTodaysVerse();

            document.getElementById('verse').innerText = `"${todaysVerse.text}"`;
            document.getElementById('reference').innerText = todaysVerse.reference;

            if (lastUsedDate === currentDate) {
                message.innerText = "Deus já falou contigo hoje. Volte novamente amanhã.";
                canvas.style.display = 'none';
            } else {
                localStorage.setItem('lastUsedDate', currentDate);
                canvas.style.display = 'block';
                canvas.addEventListener('mousedown', () => isDrawing = true);
                canvas.addEventListener('mouseup', () => isDrawing = false);
                canvas.addEventListener('mousemove', scratch);

                canvas.addEventListener('touchstart', (e) => { isDrawing = true; scratch(e); });
                canvas.addEventListener('touchend', () => isDrawing = false);
                canvas.addEventListener('touchmove', scratch);
            }
        }

        checkLastUsedDate();
    </script>
</body>
</html>
